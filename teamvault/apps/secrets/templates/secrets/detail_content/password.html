{% extends 'secrets/secret_detail.html' %}
{% load static %}
{% load i18n %}

{% block secret_content %}
    <div class="input-group input-group-lg">
        <input type="text" id="password-field" class="form-control" value="{{ placeholder }}"
               autocomplete="off" disabled>
        <span class="input-group-btn">
            <button class="btn btn-default" id="copy-password" type="button"
                    data-bs-toggle="tooltip"
                    data-bs-placement="top" title="{% trans "Copy to clipboard" %}">
                <i class="fa fa-clipboard"></i>
            </button>
            <button id="revealButton" class="btn btn-default" type="button"
                    data-bs-toggle="tooltip"
                    data-bs-placement="top" title="{% trans "Reveal as plain text" %}"
                    onclick="getSecret(reveal)">
                <i class="fa fa-magic"></i>
            </button>
            <button class="btn btn-default" type="button" data-bs-toggle="tooltip"
                    data-bs-placement="top"
                    title="{% trans "Show in large type" %}" onclick="getSecret(largeType);">
                <i class="fa fa-font"></i>
            </button>
        </span>
    </div>
{% endblock %}

{% block additionalJS %}
    <script>
        const largeTypeElement = document.querySelector('.large-type')
        largeTypeElement.addEventListener('mousedown', () => {
            largeTypeElement.classList.add('invisible')
            largeTypeElement.innerHTML = ''
        })

        function largeType(password) {
            largeTypeElement.classList.remove('invisible')
            largeTypeElement.innerHTML = `<div>${password}</div>`

            // TODO: Replace bigtext with something non-jquery
            $('.large-type').bigtext();
        }
    </script>
    <script>
        new ClipboardJS("#copy-password", {
            text: function () {
                return getSecretSync()['password'];
            }
        }).on('success', function (e) {
            e.clearSelection();
            notyf.success("{% trans "Password has been copied to your clipboard." %}");
        });

        new ClipboardJS("#copy-url").on('success', function (e) {
            e.clearSelection();
            notyf.success("{% trans "URL has been copied to your clipboard." %}");
        });

        new ClipboardJS("#copy-username").on('success', function (e) {
            e.clearSelection();
            notyf.success("{% trans "Username has been copied to your clipboard." %}");
        });
    </script>
{% endblock %}